<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gerador Avan√ßado de QR Code PIX</title>

  <style>
    /* ============================================================
       SISTEMA DE DESIGN E VARI√ÅVEIS DE TEMA
       - Esquema de cores adaptativo
       - Suporte a modo escuro
       - Vari√°veis CSS para consist√™ncia visual
    ============================================================ */
    :root {
      --bg-color: #f5f7fa;
      --text-color: #1c1c1c;
      --primary-color: #002244;
      --secondary-color: #fff9db;
      --accent-color: #ffe066;
      --error-color: #d9534f;
      --success-color: #5cb85c;
      --warning-color: #f0ad4e;
      --info-color: #5bc0de;
      --card-bg: #ffffff;
      --card-shadow: rgba(0, 0, 0, 0.1);
      --border-radius: 8px;
      --transition-speed: 0.3s;
      --font-main: 'Segoe UI', Arial, sans-serif;
    }

    /* ============================================================
       RESET E ESTILOS BASE
       - Normaliza√ß√£o de estilos entre navegadores
       - Configura√ß√µes de acessibilidade
    ============================================================ */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: var(--font-main);
      background-color: var(--bg-color);
      color: var(--text-color);
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      transition: background-color var(--transition-speed) ease, 
                  color var(--transition-speed) ease;
      line-height: 1.6;
    }

    /* ============================================================
       CABE√áALHO E NAVEGA√á√ÉO
       - Layout responsivo
       - Controle de tema (claro/escuro)
    ============================================================ */
    header {
      background-color: var(--primary-color);
      color: var(--secondary-color);
      padding: 1.25rem;
      text-align: center;
      width: 100%;
      position: relative;
      box-shadow: 0 2px 8px var(--card-shadow);
    }

    #darkModeBtn {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: transparent;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--secondary-color);
      transition: transform 0.2s;
    }

    #darkModeBtn:hover {
      transform: scale(1.1);
    }

    header h1 {
      font-size: 1.75rem;
      margin-bottom: 0.5rem;
    }

    header p {
      font-size: 1rem;
      opacity: 0.9;
    }

    /* ============================================================
       LAYOUT PRINCIPAL E FORMUL√ÅRIOS
       - Design responsivo
       - Acessibilidade aprimorada
       - Feedback visual para intera√ß√µes
    ============================================================ */
    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 2rem 0;
      width: 90%;
      max-width: 600px;
    }

    .input-group {
      width: 100%;
      margin-bottom: 1.5rem;
    }

    label {
      display: block;
      margin-bottom: 0.5rem;
      width: 100%;
      font-weight: bold;
      font-size: 1rem;
    }

    input[type="text"] {
      width: 100%;
      padding: 0.75rem;
      border: 2px solid var(--primary-color);
      border-radius: var(--border-radius);
      background-color: var(--card-bg);
      color: var(--text-color);
      font-size: 1rem;
      transition: border-color var(--transition-speed), 
                  box-shadow var(--transition-speed),
                  background-color var(--transition-speed), 
                  color var(--transition-speed);
    }

    input[type="text"]:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 5px var(--accent-color);
    }

    /* ============================================================
       COMPONENTES DE INFORMA√á√ÉO
       - Cards informativos
       - Indicadores de status
       - Exibi√ß√£o de metadados
    ============================================================ */
    .info-card {
      margin-top: 0.75rem;
      padding: 1rem;
      background-color: var(--card-bg);
      border-radius: var(--border-radius);
      box-shadow: 0 2px 8px var(--card-shadow);
      width: 100%;
      font-size: 0.95rem;
      transition: background-color var(--transition-speed),
                  box-shadow var(--transition-speed);
    }

    #dataType {
      display: flex;
      align-items: center;
      font-weight: 500;
      color: var(--primary-color);
    }

    #dataType .icon {
      margin-right: 0.5rem;
      font-size: 1.2rem;
    }

    #linkInfo, #pixInfo {
      display: none;
      word-break: break-all;
    }

    .info-section {
      margin-top: 0.75rem;
      padding-top: 0.75rem;
      border-top: 1px solid rgba(0,0,0,0.1);
    }

    .info-section:first-child {
      margin-top: 0;
      padding-top: 0;
      border-top: none;
    }

    .info-title {
      font-weight: bold;
      margin-bottom: 0.5rem;
      color: var(--primary-color);
    }

    .info-row {
      display: flex;
      margin-bottom: 0.4rem;
    }

    .info-label {
      font-weight: 500;
      min-width: 120px;
    }

    .info-value {
      flex: 1;
    }

    .security-badge {
      display: inline-block;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-size: 0.8rem;
      font-weight: bold;
      margin-left: 0.5rem;
    }

    .security-badge.secure {
      background-color: var(--success-color);
      color: white;
    }

    .security-badge.insecure {
      background-color: var(--error-color);
      color: white;
    }

    .security-badge.warning {
      background-color: var(--warning-color);
      color: white;
    }

    /* ============================================================
       QR CODE E FUNCIONALIDADES DE DOWNLOAD
       - Exibi√ß√£o responsiva
       - Anima√ß√µes sutis
       - Feedback visual
    ============================================================ */
    #qrcodeContainer {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 1.5rem;
      width: 100%;
    }

    #qrcode {
      display: flex;
      justify-content: center;
      width: 100%;
      margin-bottom: 1rem;
    }

    canvas {
      background-color: var(--card-bg);
      padding: 1rem;
      border-radius: var(--border-radius);
      box-shadow: 0 4px 12px var(--card-shadow);
      transition: transform var(--transition-speed), 
                  background-color var(--transition-speed),
                  box-shadow var(--transition-speed);
      max-width: 100%;
      height: auto;
    }

    canvas:hover {
      transform: scale(1.02);
      box-shadow: 0 6px 16px var(--card-shadow);
    }

    .button-group {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 0.75rem;
      margin-top: 1rem;
      width: 100%;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background-color: var(--secondary-color);
      color: var(--primary-color);
      border: 2px solid var(--primary-color);
      padding: 0.75rem 1.25rem;
      cursor: pointer;
      border-radius: var(--border-radius);
      font-weight: bold;
      font-size: 1rem;
      transition: background-color var(--transition-speed), 
                  transform 0.2s, 
                  border-color var(--transition-speed),
                  color var(--transition-speed);
    }

    .btn:hover {
      background-color: var(--accent-color);
      border-color: var(--accent-color);
      transform: translateY(-2px);
    }

    .btn:active {
      transform: translateY(0);
    }

    .btn .icon {
      margin-right: 0.5rem;
    }

    #downloadBtn, #copyBtn {
      display: none;
    }

    /* ============================================================
       RODAP√â
       - Informa√ß√µes de copyright
       - Links √∫teis
    ============================================================ */
    footer {
      text-align: center;
      padding: 1.25rem;
      background-color: var(--primary-color);
      color: var(--secondary-color);
      width: 100%;
      margin-top: auto;
      box-shadow: 0 -2px 8px var(--card-shadow);
    }

    footer a {
      color: var(--accent-color);
      text-decoration: none;
      transition: color var(--transition-speed);
    }

    footer a:hover {
      color: var(--secondary-color);
      text-decoration: underline;
    }

    /* ============================================================
       MODO ESCURO
       - Invers√£o de cores com contraste adequado
       - Transi√ß√µes suaves entre modos
    ============================================================ */
    body.dark-mode {
      --bg-color: #121212;
      --text-color: #e0e0e0;
      --primary-color: #1a237e;
      --secondary-color: #fafafa;
      --accent-color: #ffca28;
      --card-bg: #1e1e1e;
      --card-shadow: rgba(0, 0, 0, 0.3);
    }

    body.dark-mode .info-section {
      border-top-color: rgba(255,255,255,0.1);
    }

    body.dark-mode input[type="text"] {
      background-color: #2a2a2a;
      color: var(--text-color);
      border-color: #444;
    }

    body.dark-mode input[type="text"]:focus {
      border-color: var(--accent-color);
      box-shadow: 0 0 5px var(--accent-color);
    }

    /* ============================================================
       RESPONSIVIDADE
       - Adapta√ß√µes para dispositivos m√≥veis
       - Ajustes para telas pequenas
    ============================================================ */
    @media (max-width: 600px) {
      header h1 {
        font-size: 1.5rem;
      }
      
      .button-group {
        flex-direction: column;
        width: 100%;
      }
      
      .btn {
        width: 100%;
      }
      
      .info-row {
        flex-direction: column;
      }
      
      .info-label {
        min-width: auto;
        margin-bottom: 0.25rem;
      }
    }
  </style>
</head>

<body>
  <header>
    <h1>Gerador Avan√ßado de QR Code PIX</h1>
    <p>Identifica automaticamente chaves PIX, links e outros dados</p>
    <button id="darkModeBtn" aria-label="Alternar modo escuro" onclick="toggleDarkMode()">üåì</button>
  </header>

  <main>
    <!-- Se√ß√£o de entrada de dados -->
    <div class="input-group">
      <label for="qrInput">Digite uma chave PIX, link ou outro texto:</label>
      <input 
        type="text" 
        id="qrInput" 
        placeholder="Ex: email@exemplo.com, 11987654321, CPF, chave aleat√≥ria..." 
        aria-describedby="dataType"
      />
    </div>

    <!-- Exibi√ß√£o do tipo de dado detectado -->
    <div id="dataType" class="info-card">
      <span class="icon">üìã</span> Tipo de dado: aguardando entrada...
    </div>

    <!-- Informa√ß√µes detalhadas para links -->
    <div id="linkInfo" class="info-card">
      <!-- Conte√∫do preenchido via JavaScript -->
    </div>

    <!-- Informa√ß√µes detalhadas para chaves PIX -->
    <div id="pixInfo" class="info-card">
      <!-- Conte√∫do preenchido via JavaScript -->
    </div>

    <!-- Container para QR Code gerado e bot√µes de a√ß√£o -->
    <div id="qrcodeContainer">
      <div id="qrcode"></div>
      <div class="button-group">
        <button id="downloadBtn" class="btn">
          <span class="icon">‚¨áÔ∏è</span> Baixar QR Code
        </button>
        <button id="copyBtn" class="btn">
          <span class="icon">üìã</span> Copiar QR Code
        </button>
      </div>
    </div>
  </main>

  <!-- Biblioteca QR Code -->
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
  
  <script>
    /* ============================================================
     * SISTEMA DE DETEC√á√ÉO E VALIDA√á√ÉO DE DADOS
     * 
     * Este m√≥dulo implementa valida√ß√µes robustas para diferentes
     * tipos de dados, com foco especial em chaves PIX brasileiras.
     * Inclui valida√ß√£o de CPF/CNPJ, telefone, e-mail, chaves
     * aleat√≥rias e links, com verifica√ß√µes de seguran√ßa.
     * ============================================================ */
    
    /**
     * Detecta e valida o tipo de dado inserido pelo usu√°rio
     * 
     * Implementa valida√ß√µes espec√≠ficas para cada tipo de dado:
     * - Chaves PIX (CPF, CNPJ, telefone, e-mail, aleat√≥ria)
     * - URLs (com verifica√ß√£o de seguran√ßa)
     * - Outros formatos (Bitcoin, Ethereum, texto simples)
     * 
     * @param {string} text - Texto a ser analisado
     * @returns {Object} Objeto contendo tipo de dado e metadados
     */
    function detectDataType(text) {
      // Valor padr√£o para retorno
      const defaultResult = {
        type: '-',
        icon: 'üìã',
        isValid: false,
        metadata: {}
      };
      
      if (!text || text.trim() === '') return defaultResult;
      
      text = text.trim();
      
      // ========== VALIDA√á√ÉO DE LINKS ==========
      const urlResult = validateUrl(text);
      if (urlResult.isValid) return urlResult;
      
      // ========== VALIDA√á√ÉO DE E-MAIL ==========
      const emailResult = validateEmail(text);
      if (emailResult.isValid) return emailResult;
      
      // ========== VALIDA√á√ÉO DE CPF ==========
      const cpfResult = validateCpf(text);
      if (cpfResult.isValid) return cpfResult;
      
      // ========== VALIDA√á√ÉO DE CNPJ ==========
      const cnpjResult = validateCnpj(text);
      if (cnpjResult.isValid) return cnpjResult;
      
      // ========== VALIDA√á√ÉO DE TELEFONE ==========
      const phoneResult = validatePhone(text);
      if (phoneResult.isValid) return phoneResult;
      
      // ========== VALIDA√á√ÉO DE CHAVE PIX ALEAT√ìRIA ==========
      const pixRandomResult = validatePixRandom(text);
      if (pixRandomResult.isValid) return pixRandomResult;
      
      // ========== VALIDA√á√ÉO DE CRIPTOMOEDAS ==========
      
      // Bitcoin (come√ßa com 1, 3 ou bc1, 26-35 caracteres)
      const btcRegex = /^(1|3|bc1)[a-zA-HJ-NP-Z0-9]{25,59}$/;
      if (btcRegex.test(text)) {
        return {
          type: 'Endere√ßo Bitcoin',
          icon: '‚Çø',
          isValid: true,
          metadata: {
            format: text.startsWith('bc1') ? 'Bech32' : (text.startsWith('3') ? 'P2SH' : 'P2PKH')
          }
        };
      }
      
      // Ethereum (0x + 40 caracteres hexadecimais)
      const ethRegex = /^0x[a-fA-F0-9]{40}$/;
      if (ethRegex.test(text)) {
        return {
          type: 'Endere√ßo Ethereum',
          icon: 'Œû',
          isValid: true,
          metadata: {}
        };
      }
      
      // ========== TEXTO SIMPLES ==========
      return {
        type: 'Texto simples',
        icon: 'üìù',
        isValid: true,
        metadata: {
          length: text.length,
          hasSpecialChars: /[^a-zA-Z0-9\s]/.test(text)
        }
      };
    }
    
    /**
     * Valida URLs e verifica sua seguran√ßa
     * 
     * Analisa se o texto √© uma URL v√°lida, adiciona protocolo
     * se necess√°rio e verifica se √© uma conex√£o segura (HTTPS).
     * 
     * @param {string} text - Texto a ser validado como URL
     * @returns {Object} Resultado da valida√ß√£o com metadados
     */
    function validateUrl(text) {
      try {
        // Adiciona protocolo se n√£o existir
        const candidate = /^[a-zA-Z][a-zA-Z\d+\-.]*:\/\//.test(text)
          ? text
          : 'https://' + text;
        
        const parsed = new URL(candidate);
        const hostname = parsed.hostname.toLowerCase();
        
        // Verifica se √© um dom√≠nio v√°lido (com ponto e n√£o apenas IP)
        if (hostname.includes('.') && !/^[\d.]+$/.test(hostname)) {
          const isSecure = parsed.protocol === 'https:';
          
          // Lista de dom√≠nios potencialmente perigosos (exemplo)
          const suspiciousDomains = [
            'example-malware.com',
            'phishing-example.net',
            'malware-example.org'
          ];
          
          // Verifica se o dom√≠nio est√° na lista de suspeitos
          const isSuspicious = suspiciousDomains.some(domain => 
            hostname === domain || hostname.endsWith('.' + domain)
          );
          
          return {
            type: isSecure 
              ? 'Link Seguro (HTTPS)' 
              : 'Link N√£o Seguro (HTTP)',
            icon: isSecure ? 'üîí' : '‚ö†Ô∏è',
            isValid: true,
            isSecure: isSecure,
            isSuspicious: isSuspicious,
            metadata: {
              protocol: parsed.protocol,
              hostname: hostname,
              pathname: parsed.pathname,
              port: parsed.port || (isSecure ? '443' : '80'),
              search: parsed.search,
              hash: parsed.hash,
              fullUrl: parsed.toString()
            }
          };
        }
      } catch (e) {
        // N√£o √© uma URL v√°lida
      }
      
      return { isValid: false };
    }
    
    /**
     * Valida endere√ßos de e-mail
     * 
     * Implementa valida√ß√£o robusta de e-mail, verificando formato,
     * dom√≠nio e outras caracter√≠sticas.
     * 
     * @param {string} text - Texto a ser validado como e-mail
     * @returns {Object} Resultado da valida√ß√£o com metadados
     */
    function validateEmail(text) {
      // Regex mais robusta para e-mail
      const emailRegex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;
      
      if (!emailRegex.test(text)) {
        return { isValid: false };
      }
      
      const parts = text.split('@');
      const localPart = parts[0];
      const domain = parts[1];
      
      // Mapeamento de alguns dom√≠nios de e-mail para bancos (para PIX)
      const bankEmailDomains = {
        'nubank.com.br': 'Nubank',
        'itau.com.br': 'Ita√∫',
        'bradesco.com.br': 'Bradesco',
        'santander.com.br': 'Santander',
        'bb.com.br': 'Banco do Brasil',
        'caixa.gov.br': 'Caixa Econ√¥mica Federal',
        'banrisul.com.br': 'Banrisul',
        'inter.co': 'Banco Inter',
        'original.com.br': 'Banco Original',
        'c6bank.com.br': 'C6 Bank',
        'btgpactual.com': 'BTG Pactual'
      };
      
      // Tenta identificar o banco pelo dom√≠nio do e-mail
      let bankName = null;
      for (const [bankDomain, name] of Object.entries(bankEmailDomains)) {
        if (domain.endsWith(bankDomain)) {
          bankName = name;
          break;
        }
      }
      
      return {
        type: 'E-mail / Chave PIX',
        icon: '‚úâÔ∏è',
        isValid: true,
        isPix: true,
        metadata: {
          localPart: localPart,
          domain: domain,
          bankName: bankName || 'N√£o identificado',
          pixType: 'E-mail'
        }
      };
    }
    
    /**
     * Valida n√∫meros de CPF
     * 
     * Implementa valida√ß√£o completa de CPF, incluindo verifica√ß√£o
     * de d√≠gitos e formata√ß√£o.
     * 
     * @param {string} text - Texto a ser validado como CPF
     * @returns {Object} Resultado da valida√ß√£o com metadados
     */
    function validateCpf(text) {
      // Remove caracteres n√£o num√©ricos
      const cpfClean = text.replace(/\D/g, '');
      
      // Verifica se tem 11 d√≠gitos
      if (cpfClean.length !== 11) {
        return { isValid: false };
      }
      
      // Verifica se todos os d√≠gitos s√£o iguais (CPF inv√°lido)
      if (/^(\d)\1{10}$/.test(cpfClean)) {
        return { 
          type: 'CPF Inv√°lido (d√≠gitos repetidos)',
          icon: '‚ö†Ô∏è',
          isValid: false
        };
      }
      
      // Algoritmo de valida√ß√£o do CPF
      let sum = 0;
      let remainder;
      
      // Primeiro d√≠gito verificador
      for (let i = 1; i <= 9; i++) {
        sum += parseInt(cpfClean.substring(i - 1, i)) * (11 - i);
      }
      
      remainder = (sum * 10) % 11;
      if (remainder === 10 || remainder === 11) {
        remainder = 0;
      }
      
      if (remainder !== parseInt(cpfClean.substring(9, 10))) {
        return { 
          type: 'CPF Inv√°lido (d√≠gito verificador)',
          icon: '‚ö†Ô∏è',
          isValid: false
        };
      }
      
      // Segundo d√≠gito verificador
      sum = 0;
      for (let i = 1; i <= 10; i++) {
        sum += parseInt(cpfClean.substring(i - 1, i)) * (12 - i);
      }
      
      remainder = (sum * 10) % 11;
      if (remainder === 10 || remainder === 11) {
        remainder = 0;
      }
      
      if (remainder !== parseInt(cpfClean.substring(10, 11))) {
        return { 
          type: 'CPF Inv√°lido (d√≠gito verificador)',
          icon: '‚ö†Ô∏è',
          isValid: false
        };
      }
      
      // CPF v√°lido - formata para exibi√ß√£o
      const formattedCpf = cpfClean.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
      
      // Identifica√ß√£o de regi√£o pelo primeiro d√≠gito
      const regionMap = {
        '0': 'RS',
        '1': 'DF, GO, MT, MS, TO',
        '2': 'AC, AM, AP, PA, RO, RR',
        '3': 'CE, MA, PI',
        '4': 'AL, PB, PE, RN',
        '5': 'BA, SE',
        '6': 'MG',
        '7': 'ES, RJ',
        '8': 'SP',
        '9': 'PR, SC'
      };
      
      const region = regionMap[cpfClean[8]] || 'Desconhecida';
      
      return {
        type: 'CPF / Chave PIX',
        icon: 'üí≥',
        isValid: true,
        isPix: true,
        metadata: {
          cpf: formattedCpf,
          region: region,
          pixType: 'CPF'
        }
      };
    }
    
    /**
     * Valida n√∫meros de CNPJ
     * 
     * Implementa valida√ß√£o completa de CNPJ, incluindo verifica√ß√£o
     * de d√≠gitos e formata√ß√£o.
     * 
     * @param {string} text - Texto a ser validado como CNPJ
     * @returns {Object} Resultado da valida√ß√£o com metadados
     */
    function validateCnpj(text) {
      // Remove caracteres n√£o num√©ricos
      const cnpjClean = text.replace(/\D/g, '');
      
      // Verifica se tem 14 d√≠gitos
      if (cnpjClean.length !== 14) {
        return { isValid: false };
      }
      
      // Verifica se todos os d√≠gitos s√£o iguais (CNPJ inv√°lido)
      if (/^(\d)\1{13}$/.test(cnpjClean)) {
        return { 
          type: 'CNPJ Inv√°lido (d√≠gitos repetidos)',
          icon: '‚ö†Ô∏è',
          isValid: false
        };
      }
      
      // Algoritmo de valida√ß√£o do CNPJ
      let size = cnpjClean.length - 2;
      let numbers = cnpjClean.substring(0, size);
      const digits = cnpjClean.substring(size);
      let sum = 0;
      let pos = size - 7;
      
      // Primeiro d√≠gito verificador
      for (let i = size; i >= 1; i--) {
        sum += numbers.charAt(size - i) * pos--;
        if (pos < 2) pos = 9;
      }
      
      let result = sum % 11 < 2 ? 0 : 11 - sum % 11;
      if (result !== parseInt(digits.charAt(0))) {
        return { 
          type: 'CNPJ Inv√°lido (d√≠gito verificador)',
          icon: '‚ö†Ô∏è',
          isValid: false
        };
      }
      
      // Segundo d√≠gito verificador
      size = size + 1;
      numbers = cnpjClean.substring(0, size);
      sum = 0;
      pos = size - 7;
      
      for (let i = size; i >= 1; i--) {
        sum += numbers.charAt(size - i) * pos--;
        if (pos < 2) pos = 9;
      }
      
      result = sum % 11 < 2 ? 0 : 11 - sum % 11;
      if (result !== parseInt(digits.charAt(1))) {
        return { 
          type: 'CNPJ Inv√°lido (d√≠gito verificador)',
          icon: '‚ö†Ô∏è',
          isValid: false
        };
      }
      
      // CNPJ v√°lido - formata para exibi√ß√£o
      const formattedCnpj = cnpjClean.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/, '$1.$2.$3/$4-$5');
      
      return {
        type: 'CNPJ / Chave PIX',
        icon: 'üè¢',
        isValid: true,
        isPix: true,
        metadata: {
          cnpj: formattedCnpj,
          pixType: 'CNPJ'
        }
      };
    }
    
    /**
     * Valida n√∫meros de telefone brasileiros
     * 
     * Implementa valida√ß√£o robusta de telefones, suportando
     * diferentes formatos e verificando DDD v√°lido.
     * 
     * @param {string} text - Texto a ser validado como telefone
     * @returns {Object} Resultado da valida√ß√£o com metadados
     */
    function validatePhone(text) {
      // Remove caracteres n√£o num√©ricos
      const phoneClean = text.replace(/\D/g, '');
      
      // Verifica formatos v√°lidos de telefone brasileiro
      // - Com c√≥digo do pa√≠s: +55 11 98765-4321 (13 d√≠gitos)
      // - Sem c√≥digo do pa√≠s: 11 98765-4321 (11 d√≠gitos)
      // - Apenas DDD e n√∫mero: 11987654321 (10-11 d√≠gitos)
      if (![10, 11, 13].includes(phoneClean.length)) {
        return { isValid: false };
      }
      
      let countryCode = '';
      let areaCode = '';
      let number = '';
      
      // Extrai as partes do telefone
      if (phoneClean.length === 13) {
        // Formato com c√≥digo do pa√≠s (+55)
        countryCode = phoneClean.substring(0, 2);
        areaCode = phoneClean.substring(2, 4);
        number = phoneClean.substring(4);
        
        // Verifica se o c√≥digo do pa√≠s √© v√°lido para Brasil
        if (countryCode !== '55') {
          return { 
            type: 'Telefone (Internacional)',
            icon: 'üì±',
            isValid: true,
            isPix: false,
            metadata: {
              countryCode: '+' + countryCode,
              areaCode: areaCode,
              number: number.replace(/(\d{5})(\d{4})/, '$1-$2')
            }
          };
        }
      } else if (phoneClean.length === 11) {
        // Formato com DDD e 9 d√≠gitos
        areaCode = phoneClean.substring(0, 2);
        number = phoneClean.substring(2);
      } else {
        // Formato com DDD e 8 d√≠gitos (telefone fixo)
        areaCode = phoneClean.substring(0, 2);
        number = phoneClean.substring(2);
      }
      
      // Verifica se o DDD √© v√°lido (c√≥digos de √°rea do Brasil)
      const validDDDs = [
        '11', '12', '13', '14', '15', '16', '17', '18', '19', // SP
        '21', '22', '24', '27', '28', // RJ, ES
        '31', '32', '33', '34', '35', '37', '38', // MG
        '41', '42', '43', '44', '45', '46', '47', '48', '49', // PR, SC
        '51', '53', '54', '55', // RS
        '61', '62', '63', '64', '65', '66', '67', '68', '69', // Centro-Oeste e Norte
        '71', '73', '74', '75', '77', '79', // BA, SE
        '81', '82', '83', '84', '85', '86', '87', '88', '89', // Nordeste
        '91', '92', '93', '94', '95', '96', '97', '98', '99' // Norte
      ];
      
      if (!validDDDs.includes(areaCode)) {
        return { 
          type: 'Telefone (DDD inv√°lido)',
          icon: '‚ö†Ô∏è',
          isValid: false
        };
      }
      
      // Verifica se √© celular (come√ßa com 9) - apenas celulares s√£o v√°lidos para PIX
      const isMobile = number.startsWith('9');
      
      // Formata o n√∫mero para exibi√ß√£o
      const formattedNumber = isMobile 
        ? number.replace(/(\d{5})(\d{4})/, '$1-$2')
        : number.replace(/(\d{4})(\d{4})/, '$1-$2');
      
      // Mapeamento de alguns DDDs para estados
      const dddToState = {
        '11': 'S√£o Paulo (Capital)',
        '21': 'Rio de Janeiro (Capital)',
        '31': 'Minas Gerais (Belo Horizonte)',
        '41': 'Paran√° (Curitiba)',
        '51': 'Rio Grande do Sul (Porto Alegre)',
        '61': 'Distrito Federal (Bras√≠lia)',
        '71': 'Bahia (Salvador)',
        '81': 'Pernambuco (Recife)',
        '91': 'Par√° (Bel√©m)'
      };
      
      return {
        type: isMobile ? 'Celular / Chave PIX' : 'Telefone Fixo',
        icon: 'üì±',
        isValid: true,
        isPix: isMobile, // Apenas celulares s√£o v√°lidos para PIX
        metadata: {
          countryCode: countryCode ? '+' + countryCode : '+55',
          areaCode: areaCode,
          number: formattedNumber,
          fullNumber: `+55 (${areaCode}) ${formattedNumber}`,
          region: dddToState[areaCode] || 'Brasil',
          isMobile: isMobile,
          pixType: isMobile ? 'Telefone' : null
        }
      };
    }
    
    /**
     * Valida chaves PIX aleat√≥rias (UUID)
     * 
     * Verifica se o texto corresponde ao formato de chave
     * aleat√≥ria PIX (UUID).
     * 
     * @param {string} text - Texto a ser validado como chave PIX aleat√≥ria
     * @returns {Object} Resultado da valida√ß√£o com metadados
     */
    function validatePixRandom(text) {
      // Regex para UUID (chave aleat√≥ria PIX)
      const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;
      
      if (!uuidRegex.test(text)) {
        return { isValid: false };
      }
      
      return {
        type: 'Chave PIX Aleat√≥ria',
        icon: 'üîë',
        isValid: true,
        isPix: true,
        metadata: {
          uuid: text.toLowerCase(),
          pixType: 'Chave aleat√≥ria'
        }
      };
    }
    
    /* ============================================================
     * SISTEMA DE GERA√á√ÉO E MANIPULA√á√ÉO DE QR CODE
     * 
     * Este m√≥dulo implementa a gera√ß√£o de QR Codes otimizados,
     * com suporte a download e c√≥pia para √°rea de transfer√™ncia.
     * ============================================================ */
    
    /**
     * Gera QR Code a partir do texto fornecido
     * 
     * Cria um QR Code otimizado com alta corre√ß√£o de erros,
     * permitindo personaliza√ß√£o visual e download.
     * 
     * @param {string} text - Texto para gerar o QR Code
     * @param {Object} dataInfo - Informa√ß√µes sobre o tipo de dado
     */
    function generateQRCode(text, dataInfo) {
      const qrcodeContainer = document.getElementById('qrcode');
      qrcodeContainer.innerHTML = '';
      
      const downloadBtn = document.getElementById('downloadBtn');
      const copyBtn = document.getElementById('copyBtn');
      
      if (!text) {
        downloadBtn.style.display = 'none';
        copyBtn.style.display = 'none';
        return;
      }
      
      // Configura√ß√µes avan√ßadas para o QR Code
      const qrOptions = {
        errorCorrectionLevel: 'H', // Alta corre√ß√£o de erros
        width: 280,
        margin: 4,
        color: {
          dark: "#000000",
          light: "#FFFFFF"
        }
      };
      
      // Gera o QR Code
      QRCode.toCanvas(text, qrOptions, function (err, canvas) {
        if (err) {
          console.error('Erro ao gerar QR Code:', err);
          return;
        }
        
        qrcodeContainer.appendChild(canvas);
        
        // Prepara nome de arquivo seguro para download
        let fileName = 'qrcode';
        
        // Adiciona prefixo baseado no tipo de dado
        if (dataInfo && dataInfo.isValid) {
          if (dataInfo.isPix) {
            fileName = 'pix';
            
            // Adiciona tipo espec√≠fico de PIX
            if (dataInfo.metadata && dataInfo.metadata.pixType) {
              const pixType = dataInfo.metadata.pixType.toLowerCase()
                .replace(/\s+/g, '_')
                .normalize('NFD')
                .replace(/[\u0300-\u036f]/g, ''); // Remove acentos
              
              fileName += '_' + pixType;
            }
          } else if (dataInfo.type.includes('Link')) {
            fileName = 'link';
          } else if (dataInfo.type.includes('Bitcoin')) {
            fileName = 'btc';
          } else if (dataInfo.type.includes('Ethereum')) {
            fileName = 'eth';
          }
        }
        
        // Adiciona parte do conte√∫do ao nome do arquivo (limitado e sanitizado)
        const contentPart = text.substring(0, 20)
          .replace(/[^a-zA-Z0-9]/g, '_')
          .toLowerCase();
        
        fileName += '_' + contentPart;
        
        // Configura bot√£o de download
        downloadBtn.style.display = 'inline-flex';
        downloadBtn.onclick = function() {
          const link = document.createElement('a');
          link.download = fileName + '.png';
          link.href = canvas.toDataURL('image/png');
          link.click();
        };
        
        // Configura bot√£o de c√≥pia
        copyBtn.style.display = 'inline-flex';
        copyBtn.onclick = function() {
          canvas.toBlob(function(blob) {
            try {
              // Tenta usar a API moderna de √°rea de transfer√™ncia
              navigator.clipboard.write([
                new ClipboardItem({ 'image/png': blob })
              ]).then(() => {
                alert('QR Code copiado para a √°rea de transfer√™ncia!');
              }).catch(err => {
                console.error('Erro ao copiar QR Code:', err);
                alert('N√£o foi poss√≠vel copiar o QR Code. Use o bot√£o de download.');
              });
            } catch (e) {
              alert('Seu navegador n√£o suporta c√≥pia de imagens. Use o bot√£o de download.');
            }
          });
        };
      });
    }
    
    /* ============================================================
     * SISTEMA DE INFORMA√á√ïES DETALHADAS
     * 
     * Este m√≥dulo gera informa√ß√µes detalhadas sobre os dados
     * detectados, como detalhes de links e chaves PIX.
     * ============================================================ */
    
    /**
     * Exibe informa√ß√µes detalhadas sobre links
     * 
     * Analisa e exibe metadados de URLs, incluindo protocolo,
     * dom√≠nio, caminho e informa√ß√µes de seguran√ßa.
     * 
     * @param {Object} urlInfo - Informa√ß√µes da URL validada
     */
    function displayLinkInfo(urlInfo) {
      const infoBox = document.getElementById('linkInfo');
      infoBox.style.display = 'none';
      infoBox.innerHTML = '';
      
      if (!urlInfo || !urlInfo.isValid) return;
      
      const metadata = urlInfo.metadata;
      const isSecure = urlInfo.isSecure;
      const isSuspicious = urlInfo.isSuspicious;
      
      let securityBadge = '';
      if (isSecure && !isSuspicious) {
        securityBadge = '<span class="security-badge secure">SEGURO</span>';
      } else if (!isSecure && !isSuspicious) {
        securityBadge = '<span class="security-badge warning">N√ÉO SEGURO</span>';
      } else {
        securityBadge = '<span class="security-badge insecure">SUSPEITO</span>';
      }
      
      let html = `
        <div class="info-section">
          <div class="info-title">Informa√ß√µes do Link ${securityBadge}</div>
          
          <div class="info-row">
            <div class="info-label">URL Completa:</div>
            <div class="info-value">${metadata.fullUrl}</div>
          </div>
          
          <div class="info-row">
            <div class="info-label">Protocolo:</div>
            <div class="info-value">${metadata.protocol.replace(':', '')}</div>
          </div>
          
          <div class="info-row">
            <div class="info-label">Dom√≠nio:</div>
            <div class="info-value">${metadata.hostname}</div>
          </div>
      `;
      
      if (metadata.port && metadata.port !== '80' && metadata.port !== '443') {
        html += `
          <div class="info-row">
            <div class="info-label">Porta:</div>
            <div class="info-value">${metadata.port}</div>
          </div>
        `;
      }
      
      if (metadata.pathname && metadata.pathname !== '/') {
        html += `
          <div class="info-row">
            <div class="info-label">Caminho:</div>
            <div class="info-value">${metadata.pathname}</div>
          </div>
        `;
      }
      
      if (metadata.search) {
        html += `
          <div class="info-row">
            <div class="info-label">Par√¢metros:</div>
            <div class="info-value">${metadata.search}</div>
          </div>
        `;
      }
      
      html += `
        <div class="info-row">
          <div class="info-label">Recomenda√ß√£o:</div>
          <div class="info-value">
            ${isSecure && !isSuspicious 
              ? 'Este link usa HTTPS, o que ajuda a proteger a conex√£o.' 
              : 'Tenha cuidado ao acessar este link. Verifique se o dom√≠nio √© confi√°vel.'}
          </div>
        </div>
      `;
      
      html += '</div>';
      
      infoBox.innerHTML = html;
      infoBox.style.display = 'block';
      
      // Oculta informa√ß√µes de PIX quando exibindo informa√ß√µes de link
      document.getElementById('pixInfo').style.display = 'none';
    }
    
    /**
     * Exibe informa√ß√µes detalhadas sobre chaves PIX
     * 
     * Analisa e exibe metadados de chaves PIX, incluindo tipo,
     * banco (quando identific√°vel) e outras informa√ß√µes relevantes.
     * 
     * @param {Object} pixInfo - Informa√ß√µes da chave PIX validada
     */
    function displayPixInfo(pixInfo) {
      const infoBox = document.getElementById('pixInfo');
      infoBox.style.display = 'none';
      infoBox.innerHTML = '';
      
      if (!pixInfo || !pixInfo.isValid || !pixInfo.isPix) return;
      
      const metadata = pixInfo.metadata;
      const pixType = metadata.pixType;
      
      let html = `
        <div class="info-section">
          <div class="info-title">Informa√ß√µes da Chave PIX</div>
          
          <div class="info-row">
            <div class="info-label">Tipo de Chave:</div>
            <div class="info-value">${pixType}</div>
          </div>
      `;
      
      // Informa√ß√µes espec√≠ficas por tipo de chave PIX
      switch (pixType) {
        case 'CPF':
          html += `
            <div class="info-row">
              <div class="info-label">CPF:</div>
              <div class="info-value">${metadata.cpf}</div>
            </div>
            <div class="info-row">
              <div class="info-label">Regi√£o Fiscal:</div>
              <div class="info-value">${metadata.region}</div>
            </div>
          `;
          break;
          
        case 'CNPJ':
          html += `
            <div class="info-row">
              <div class="info-label">CNPJ:</div>
              <div class="info-value">${metadata.cnpj}</div>
            </div>
          `;
          break;
          
        case 'Telefone':
          html += `
            <div class="info-row">
              <div class="info-label">N√∫mero:</div>
              <div class="info-value">${metadata.fullNumber}</div>
            </div>
            <div class="info-row">
              <div class="info-label">Regi√£o:</div>
              <div class="info-value">${metadata.region}</div>
            </div>
          `;
          break;
          
        case 'E-mail':
          html += `
            <div class="info-row">
              <div class="info-label">E-mail:</div>
              <div class="info-value">${metadata.localPart}@${metadata.domain}</div>
            </div>
          `;
          
          if (metadata.bankName && metadata.bankName !== 'N√£o identificado') {
            html += `
              <div class="info-row">
                <div class="info-label">Poss√≠vel Banco:</div>
                <div class="info-value">${metadata.bankName}</div>
              </div>
            `;
          }
          break;
          
        case 'Chave aleat√≥ria':
          html += `
            <div class="info-row">
              <div class="info-label">UUID:</div>
              <div class="info-value">${metadata.uuid}</div>
            </div>
          `;
          break;
      }
      
      html += `
        <div class="info-row">
          <div class="info-label">Observa√ß√£o:</div>
          <div class="info-value">
            Este QR Code pode ser usado para pagamentos via PIX.
            Confirme sempre os dados do destinat√°rio antes de efetuar pagamentos.
          </div>
        </div>
      `;
      
      html += '</div>';
      
      infoBox.innerHTML = html;
      infoBox.style.display = 'block';
      
      // Oculta informa√ß√µes de link quando exibindo informa√ß√µes de PIX
      document.getElementById('linkInfo').style.display = 'none';
    }
    
    /* ============================================================
     * SISTEMA DE INTERFACE E INTERA√á√ÉO
     * 
     * Este m√≥dulo gerencia a interface do usu√°rio, incluindo
     * eventos, modo escuro e atualiza√ß√µes em tempo real.
     * ============================================================ */
    
    /**
     * Atualiza a interface com base no texto inserido
     * 
     * Processa o texto inserido, detecta o tipo de dado,
     * gera o QR Code e exibe informa√ß√µes relevantes.
     */
    function updateInterface() {
      const inputElement = document.getElementById('qrInput');
      const text = inputElement.value.trim();
      const dataTypeElement = document.getElementById('dataType');
      
      // Detecta o tipo de dado
      const dataInfo = detectDataType(text);
      
      // Atualiza o indicador de tipo de dado
      if (dataInfo.isValid) {
        dataTypeElement.innerHTML = `<span class="icon">${dataInfo.icon}</span> Tipo de dado: ${dataInfo.type}`;
      } else {
        dataTypeElement.innerHTML = `<span class="icon">üìã</span> Tipo de dado: aguardando entrada v√°lida...`;
      }
      
      // Exibe informa√ß√µes espec√≠ficas com base no tipo de dado
      if (dataInfo.type.includes('Link')) {
        displayLinkInfo(dataInfo);
      } else if (dataInfo.isPix) {
        displayPixInfo(dataInfo);
      } else {
        document.getElementById('linkInfo').style.display = 'none';
        document.getElementById('pixInfo').style.display = 'none';
      }
      
      // Gera o QR Code
      generateQRCode(text, dataInfo);
    }
    
    /**
     * Alterna entre modo claro e escuro
     * 
     * Implementa a funcionalidade de alternar entre temas,
     * salvando a prefer√™ncia do usu√°rio.
     */
    function toggleDarkMode() {
      const body = document.body;
      body.classList.toggle('dark-mode');
      
      // Salva a prefer√™ncia do usu√°rio
      const isDarkMode = body.classList.contains('dark-mode');
      localStorage.setItem('darkMode', isDarkMode);
      
      // Atualiza o √≠cone do bot√£o
      const darkModeBtn = document.getElementById('darkModeBtn');
      darkModeBtn.textContent = isDarkMode ? '‚òÄÔ∏è' : 'üåì';
    }
    
    /* ============================================================
     * INICIALIZA√á√ÉO E CONFIGURA√á√ÉO
     * 
     * Este m√≥dulo configura os eventos e inicializa a aplica√ß√£o,
     * incluindo a restaura√ß√£o de prefer√™ncias do usu√°rio.
     * ============================================================ */
    
    // Configura evento de entrada para atualiza√ß√£o em tempo real
    document.getElementById('qrInput').addEventListener('input', updateInterface);
    
    // Inicializa a interface
    document.addEventListener('DOMContentLoaded', function() {
      // Restaura prefer√™ncia de modo escuro
      const savedDarkMode = localStorage.getItem('darkMode');
      if (savedDarkMode === 'true') {
        document.body.classList.add('dark-mode');
        document.getElementById('darkModeBtn').textContent = '‚òÄÔ∏è';
      }
      
      // Foca no campo de entrada
      document.getElementById('qrInput').focus();
    });
  </script>
</body>
</html>
